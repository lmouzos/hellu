package com.lambdami.hellu.searchsata.googleresults;

import com.lambdami.hellu.model.CitedPublication;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import java.util.Arrays;
import java.util.List;

import static org.junit.jupiter.api.Assertions.*;

class DataFromPublicationsTest {

    private final String content = "<div class=\"gs_r gs_or gs_scl\" data-cid=\"XIg04o1-kGUJ\" data-did=\"XIg04o1-kGUJ\" data-lid=\"\" data-aid=\"XIg04o1-kGUJ\" data-rp=\"0\"><div class=\"gs_ggs gs_fl\"><div class=\"gs_ggsd\"><div class=\"gs_or_ggsm\" ontouchstart=\"gs_evt_dsp(event)\" tabindex=\"-1\"><a href=\"https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0112963\" data-clk=\"hl=en&amp;sa=T&amp;oi=gga&amp;ct=gga&amp;cd=0&amp;d=7318488542327638108&amp;ei=RatVYqSGGo6pywSdh6agAg\" data-clk-atid=\"XIg04o1-kGUJ\"><span class=\"gs_ctg2\">[HTML]</span> plos.org</a></div></div></div><div class=\"gs_ri\"><h3 class=\"gs_rt\" ontouchstart=\"gs_evt_dsp(event)\"><span class=\"gs_ctc\"><span class=\"gs_ct1\">[HTML]</span><span class=\"gs_ct2\">[HTML]</span></span> <a id=\"XIg04o1-kGUJ\" href=\"https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0112963\" data-clk=\"hl=en&amp;sa=T&amp;oi=ggp&amp;ct=res&amp;cd=0&amp;d=7318488542327638108&amp;ei=RatVYqSGGo6pywSdh6agAg\" data-clk-atid=\"XIg04o1-kGUJ\">Pilon: an integrated tool for comprehensive microbial variant detection and genome assembly improvement</a></h3><div class=\"gs_a\">BJ Walker, <a href=\"/citations?user=SLuGeK4AAAAJ&amp;hl=en&amp;num=20&amp;oi=sra\">T <b>Abeel</b></a>, T Shea, M Priest, A Abouelliel…&nbsp;- PloS one, 2014 - journals.plos.org</div><div class=\"gs_rs\">Advances in modern sequencing technologies allow us to generate sufficient data to <br>analyze hundreds of bacterial genomes from a single machine in a single day. This potential&nbsp;…</div><div class=\"gs_fl\"><a href=\"javascript:void(0)\" class=\"gs_or_sav gs_or_btn\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M7.5 11.57l3.824 2.308-1.015-4.35 3.379-2.926-4.45-.378L7.5 2.122 5.761 6.224l-4.449.378 3.379 2.926-1.015 4.35z\"></path></svg><span class=\"gs_or_btn_lbl\">Save</span></a> <a href=\"javascript:void(0)\" class=\"gs_or_cit gs_or_btn gs_nph\" role=\"button\" aria-controls=\"gs_cit\" aria-haspopup=\"true\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M6.5 3.5H1.5V8.5H3.75L1.75 12.5H4.75L6.5 9V3.5zM13.5 3.5H8.5V8.5H10.75L8.75 12.5H11.75L13.5 9V3.5z\"></path></svg><span>Cite</span></a> <a href=\"/scholar?cites=7318488542327638108&amp;as_sdt=2005&amp;sciodt=0,5&amp;hl=en&amp;num=20\">Cited by 4152</a> <a href=\"/scholar?q=related:XIg04o1-kGUJ:scholar.google.com/&amp;scioq=author:thomas%2Babeel&amp;hl=en&amp;num=20&amp;as_sdt=0,5\">Related articles</a> <a href=\"/scholar?cluster=7318488542327638108&amp;hl=en&amp;num=20&amp;as_sdt=0,5\" class=\"gs_nph\">All 15 versions</a> <a href=\"javascript:void(0)\" title=\"More\" class=\"gs_or_mor\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M0.75 5.5l2-2L7.25 8l-4.5 4.5-2-2L3.25 8zM7.75 5.5l2-2L14.25 8l-4.5 4.5-2-2L10.25 8z\"></path></svg></a> <a href=\"https://scholar.googleusercontent.com/scholar?q=cache:XIg04o1-kGUJ:scholar.google.com/+author:thomas%2Babeel&amp;hl=en&amp;num=20&amp;as_sdt=0,5\" class=\"gs_or_nvi\">Cached</a> <a href=\"javascript:void(0)\" title=\"Fewer\" class=\"gs_or_nvi gs_or_mor\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M7.25 5.5l-2-2L0.75 8l4.5 4.5 2-2L4.75 8zM14.25 5.5l-2-2L7.75 8l4.5 4.5 2-2L11.75 8z\"></path></svg></a></div></div></div>";
    private final String content2 = "<div class=\"gs_r gs_or gs_scl\" data-cid=\"P14DCwYZ4DcJ\" data-did=\"P14DCwYZ4DcJ\" data-lid=\"\" data-aid=\"P14DCwYZ4DcJ\" data-rp=\"1\"><div class=\"gs_ggs gs_fl\"><div class=\"gs_ggsd\"><div class=\"gs_or_ggsm\" ontouchstart=\"gs_evt_dsp(event)\" tabindex=\"-1\"><a href=\"https://link.springer.com/content/pdf/10.1007/978-3-540-87481-2_21.pdf\" data-clk=\"hl=en&amp;sa=T&amp;oi=gga&amp;ct=gga&amp;cd=1&amp;d=4026245580614491711&amp;ei=RatVYqSGGo6pywSdh6agAg\" data-clk-atid=\"P14DCwYZ4DcJ\"><span class=\"gs_ctg2\">[PDF]</span> springer.com</a></div></div></div><div class=\"gs_ri\"><h3 class=\"gs_rt\" ontouchstart=\"gs_evt_dsp(event)\"><a id=\"P14DCwYZ4DcJ\" href=\"https://link.springer.com/chapter/10.1007/978-3-540-87481-2_21\" data-clk=\"hl=en&amp;sa=T&amp;ct=res&amp;cd=1&amp;d=4026245580614491711&amp;ei=RatVYqSGGo6pywSdh6agAg\" data-clk-atid=\"P14DCwYZ4DcJ\">Robust feature selection using ensemble feature selection techniques</a></h3><div class=\"gs_a\"><a href=\"/citations?user=1GNeT0cAAAAJ&amp;hl=en&amp;num=20&amp;oi=sra\">Y Saeys</a>, <a href=\"/citations?user=SLuGeK4AAAAJ&amp;hl=en&amp;num=20&amp;oi=sra\">T <b>Abeel</b></a>, <a href=\"/citations?user=tBs2BVMAAAAJ&amp;hl=en&amp;num=20&amp;oi=sra\">YV Peer</a>&nbsp;- …&nbsp;machine learning and knowledge discovery in&nbsp;…, 2008 - Springer</div><div class=\"gs_rs\">Robustness or stability of feature selection techniques is a topic of recent interest, and is an <br>important issue when selected feature subsets are subsequently analysed by domain&nbsp;…</div><div class=\"gs_fl\"><a href=\"javascript:void(0)\" class=\"gs_or_sav gs_or_btn\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M7.5 11.57l3.824 2.308-1.015-4.35 3.379-2.926-4.45-.378L7.5 2.122 5.761 6.224l-4.449.378 3.379 2.926-1.015 4.35z\"></path></svg><span class=\"gs_or_btn_lbl\">Save</span></a> <a href=\"javascript:void(0)\" class=\"gs_or_cit gs_or_btn gs_nph\" role=\"button\" aria-controls=\"gs_cit\" aria-haspopup=\"true\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M6.5 3.5H1.5V8.5H3.75L1.75 12.5H4.75L6.5 9V3.5zM13.5 3.5H8.5V8.5H10.75L8.75 12.5H11.75L13.5 9V3.5z\"></path></svg><span>Cite</span></a> <a href=\"/scholar?cites=4026245580614491711&amp;as_sdt=2005&amp;sciodt=0,5&amp;hl=en&amp;num=20\">Cited by 685</a> <a href=\"/scholar?q=related:P14DCwYZ4DcJ:scholar.google.com/&amp;scioq=author:thomas%2Babeel&amp;hl=en&amp;num=20&amp;as_sdt=0,5\">Related articles</a> <a href=\"/scholar?cluster=4026245580614491711&amp;hl=en&amp;num=20&amp;as_sdt=0,5\" class=\"gs_nph\">All 10 versions</a> <a href=\"javascript:void(0)\" title=\"More\" class=\"gs_or_mor gs_oph\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M0.75 5.5l2-2L7.25 8l-4.5 4.5-2-2L3.25 8zM7.75 5.5l2-2L14.25 8l-4.5 4.5-2-2L10.25 8z\"></path></svg></a> <a href=\"javascript:void(0)\" title=\"Fewer\" class=\"gs_or_nvi gs_or_mor\" role=\"button\"><svg viewBox=\"0 0 15 16\" class=\"gs_or_svg\"><path d=\"M7.25 5.5l-2-2L0.75 8l4.5 4.5 2-2L4.75 8zM14.25 5.5l-2-2L7.75 8l4.5 4.5 2-2L11.75 8z\"></path></svg></a></div></div></div>";

    private final List<String> publications = Arrays.asList(content, content2);

    private final DataFromPublications underTest = new DataFromPublications(publications);

    @Test
    @DisplayName("parse publications from html")
    void test1() {
        List<CitedPublication> result = underTest.parseData();
        assertEquals(2, result.size());
        assertEquals(3, result.get(0).getCitations());
    }

}